
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>3. 組件 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="4. Basic Controls.html" />
    
    
    <link rel="prev" href="2. Setting Up.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="0. Subsection.html">
            
                <a href="0. Subsection.html">
            
                    
                    第一部分: TornadoFX 基本介紹
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="1. Why TornadoFX.html">
            
                <a href="1. Why TornadoFX.html">
            
                    
                    1. 為什麼選擇 TornadoFX?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="2. Setting Up.html">
            
                <a href="2. Setting Up.html">
            
                    
                    2. 配置
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.3" data-path="3. Components.html">
            
                <a href="3. Components.html">
            
                    
                    3. 組件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="4. Basic Controls.html">
            
                <a href="4. Basic Controls.html">
            
                    
                    4. Basic Controls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="5. Data Controls.html">
            
                <a href="5. Data Controls.html">
            
                    
                    5. Data Controls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="6. CSS.html">
            
                <a href="6. CSS.html">
            
                    
                    6. Type Safe CSS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="7. Layouts and Menus.html">
            
                <a href="7. Layouts and Menus.html">
            
                    
                    7. Layouts and Menus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="8. Charts.html">
            
                <a href="8. Charts.html">
            
                    
                    8. Charts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="9. Shapes and Animation.html">
            
                <a href="9. Shapes and Animation.html">
            
                    
                    9. Shapes and Animation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="10. FXML.html">
            
                <a href="10. FXML.html">
            
                    
                    10. FXML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="11. Editing Models and Validation.html">
            
                <a href="11. Editing Models and Validation.html">
            
                    
                    11. Editing Models and Validation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="12. TornadoFX IDEA Plugin.html">
            
                <a href="12. TornadoFX IDEA Plugin.html">
            
                    
                    12. TornadoFX IDEA Plugin
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../part2/0. Subsection.html">
            
                <a href="../part2/0. Subsection.html">
            
                    
                    Part 2: TornadoFX Advanced Features
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../part2/Property Delegates.html">
            
                <a href="../part2/Property Delegates.html">
            
                    
                    Property Delegates
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../part2/Advanced Data Controls.html">
            
                <a href="../part2/Advanced Data Controls.html">
            
                    
                    Advanced Data Controls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../part2/OSGi.html">
            
                <a href="../part2/OSGi.html">
            
                    
                    OSGi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../part2/Scopes.html">
            
                <a href="../part2/Scopes.html">
            
                    
                    Scopes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../part2/EventBus.html">
            
                <a href="../part2/EventBus.html">
            
                    
                    EventBus
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../part2/Workspaces.html">
            
                <a href="../part2/Workspaces.html">
            
                    
                    Workspaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../part2/Layout Debugger.html">
            
                <a href="../part2/Layout Debugger.html">
            
                    
                    Layout Debugger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../part2/Internationalization.html">
            
                <a href="../part2/Internationalization.html">
            
                    
                    Internationalization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../part2/Config Settings and State.html">
            
                <a href="../part2/Config Settings and State.html">
            
                    
                    Config Settings and State
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../part2/JSON and REST.html">
            
                <a href="../part2/JSON and REST.html">
            
                    
                    JSON and REST
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="../part2/Dependency Injection.html">
            
                <a href="../part2/Dependency Injection.html">
            
                    
                    Dependency Injection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="../part2/Wizard.html">
            
                <a href="../part2/Wizard.html">
            
                    
                    Wizard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.13" data-path="../part2/Integration.html">
            
                <a href="../part2/Integration.html">
            
                    
                    Integrating with other tech
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../part3/0. Subsection.html">
            
                <a href="../part3/0. Subsection.html">
            
                    
                    Part 3: Cook Book
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../part3/Snippets.html">
            
                <a href="../part3/Snippets.html">
            
                    
                    Snippets
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >3. 組件</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x7D44;&#x4EF6;">&#x7D44;&#x4EF6;</h1>
<p>JavaFX &#x7528;&#x6232;&#x5287;&#x4F86;&#x6BD4;&#x55BB; <code>Application</code>&#x3001;<code>Stage</code>&#x3001;<code>Scene</code> &#x4E4B;&#x9593;&#x7684;&#x7D44;&#x7E54;&#x3002;</p>
<p>TornadoFX &#x7528; <code>View</code>&#x3001;<code>Controller</code>&#x3001;<code>Fragment</code> &#x4F86;&#x69CB;&#x5EFA;&#x3002;&#x96D6;&#x7136; TornadoFX &#x4E5F;&#x4F7F;&#x7528; <code>Stage</code>&#x3001;<code>Scene</code>&#xFF0C;&#x4F46;&#x662F; <code>View</code>&#x3001;<code>Controller</code>&#x3001;<code>Fragment</code> &#x63D0;&#x4F9B;&#x4E86;&#x65B0;&#x7684;&#x6982;&#x5FF5;&#x4F86;&#x8B93;&#x958B;&#x767C;&#x7684;&#x7A0B;&#x5F0F;&#x78BC;&#x66F4;&#x7CBE;&#x7C21;&#x3002;&#x5927;&#x90E8;&#x5206;&#x7684;&#x7D44;&#x4EF6;&#x90FD;&#x81EA;&#x52D5;&#x7684;&#x7DAD;&#x6301;&#x55AE;&#x4E00;&#x7269;&#x4EF6; (singletons)&#xFF0C;TornadoFX &#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x4F9D;&#x8CF4;&#x6CE8;&#x5165;(simple dependency)&#xFF0C;&#x6216;&#x662F;&#x76F4;&#x63A5;&#x5BE6;&#x4F8B;&#x5316;(direct instantiation)&#x3002;</p>
<p>&#x60A8;&#x4E5F;&#x53EF;&#x4EE5;&#x5229;&#x7528; <code>FXML</code>&#xFF0C;&#x9019;&#x6703;&#x5728;&#x7B2C;&#x5341;&#x7AE0;&#x4ECB;&#x7D39;&#x3002;</p>
<p>&#x9996;&#x5148;&#xFF0C;&#x8B93;&#x6211;&#x5011;&#x7E7C;&#x627F; <code>App</code> &#x4F86;&#x5275;&#x5EFA;&#x4E00;&#x500B; TornadoFX &#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x7684;&#x9032;&#x5165;&#x9EDE;&#x3002;</p>
<h2 id="&#x61C9;&#x7528;&#x7A0B;&#x5F0F;app-&#x548C;-view-&#x57FA;&#x790E;">&#x61C9;&#x7528;&#x7A0B;&#x5F0F;(App) &#x548C; View &#x57FA;&#x790E;</h2>
<p>&#x8981;&#x5275;&#x5EFA;&#x4E00;&#x500B; TornadoFX &#x7684;&#x61C9;&#x7528;&#x7A0B;&#x5E8F;&#xFF0C;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x4E00;&#x500B;&#x985E;&#x5225;&#x7E7C;&#x627F;(extends) <code>App</code>&#xFF0C;<code>App</code> &#x662F;&#x4E00;&#x500B;&#x7A0B;&#x5E8F;&#x7684;&#x9032;&#x5165;&#x9EDE;&#xFF0C;&#x4E5F;&#x6307;&#x5B9A;&#x4E86;&#x521D;&#x59CB;&#x7684; <code>View</code>&#x3002;&#x4ED6;&#x5BE6;&#x969B;&#x4E0A;&#x7E7C;&#x627F;&#x4E86; JavaFX &#x7684; <code>Application</code> &#x985E;&#xFF0C;&#x4F46;&#x60A8;&#x4E26;&#x4E0D;&#x9700;&#x8981;&#x6307;&#x5B9A; <code>start()</code> &#x548C; <code>main()</code> &#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x7E7C;&#x627F; <code>App</code> &#x4F86;&#x5275;&#x5EFA;&#x61C9;&#x7528;&#xFF0C;&#x4E14;&#x9808;&#x5728;&#x5EFA;&#x69CB;&#x5B50;(constructor) &#x4E2D;&#x7684;&#x7B2C;&#x4E00;&#x500B;&#x53C3;&#x6578;&#x4E2D;&#x653E;&#x5165;&#x4E3B;&#x8981;<code>view</code>&#x3002;</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> tornadofx.*

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span>: <span class="hljs-type">App</span></span>(MyView::<span class="hljs-class"><span class="hljs-keyword">class</span>)</span>
</code></pre>
<p><code>View</code> &#x63D0;&#x4F9B;&#x4E86;&#x986F;&#x793A;&#x908F;&#x8F2F; (display logic) &#x548C;&#x5E03;&#x5C40;&#x7BC0;&#x9EDE; (latout nodes)&#xFF0C;&#x5C31;&#x50CF;&#x662F; JavaFX &#x4E2D;&#x7684; <code>Stage</code>&#xFF0C;&#x4E5F;&#x88AB;&#x81EA;&#x52D5;&#x7684;&#x4EE5;&#x55AE;&#x4E00;&#x7269;&#x4EF6; (singleton)&#x7684;&#x65B9;&#x5F0F;&#x7BA1;&#x7406;&#x3002;&#x7576;&#x4F60;&#x5BA3;&#x544A;&#x4E86;&#x4E00;&#x500B; <code>View</code>&#xFF0C;&#x4F60;&#x5FC5;&#x9808;&#x6307;&#x5730;&#x4E00;&#x500B; <code>root</code> &#x5C6C;&#x6027;&#xFF0C;&#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x4F55;&#x7684;&#x7236;&#x985E;&#xFF0C;&#x4E14;&#x6703;&#x6301;&#x6709; view &#x7684;&#x5167;&#x5BB9;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x76F8;&#x540C;&#x7684; Kotlin &#x6A94;&#x6848;&#xFF0C;&#x6216;&#x662F;&#x5275;&#x5EFA;&#x4E00;&#x500B;&#x65B0;&#x7684;&#x6A94;&#x6848;&#x4F86;&#x5275;&#x5EFA;&#x7E7C;&#x627F; <code>View</code> &#x7684;&#x985E;&#x5225;&#x3002;&#x8986;&#x5BEB; <code>root</code> &#x5C6C;&#x6027;&#xFF0C;&#x4E26;&#x7D66;&#x4E00;&#x500B; <code>VBox</code> &#x6216;&#x662F;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x9078;&#x64C7;&#x5176;&#x4ED6;&#x7684; <code>Node</code>&#x3002;</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> tornadofx.*

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView</span>: <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = vbox {
    }
}
</code></pre>
<p>&#x7136;&#x800C;&#xFF0C;&#x82E5;&#x8981;&#x771F;&#x6B63;&#x7684;&#x986F;&#x793A;&#x4E00;&#x4E9B;&#x6771;&#x897F;&#x5728;&#x756B;&#x9762;&#x4E0A;&#xFF0C;&#x6211;&#x5011;&#x60F3;&#x8981;&#x586B;&#x5145; <code>VBox</code> &#x4F86;&#x7576;&#x4F5C; <code>root</code> &#x7684;&#x5143;&#x4EF6;&#xFF0C;&#x4F7F;&#x7528; <a href="https://kotlinlang.org/docs/reference/classes.html#constructors" target="_blank">initializer block</a> &#x4F86;&#x5275;&#x5EFA; JavaFX &#x7684; <code>Button</code> &#x548C; <code>Label</code>&#x3002;</p>
<p>&#x8ACB;&#x6CE8;&#x610F;&#x5C0E;&#x5165; (import) <code>tornadofx.*</code>&#xFF0C;&#x9019;&#x6703;&#x5C0E;&#x5165;&#x6240;&#x6709; TornadoFX &#x76F8;&#x95DC;&#x7684;&#x6A94;&#x6848;&#x3002;&#x5982;&#x679C;&#x6C92;&#x6709;&#x9019;&#x6A23;&#x5C0E;&#x5165;&#xFF0C;&#x6709;&#x4E00;&#x4E9B;&#x8F03;&#x7279;&#x6B8A;&#x7684;&#x65B9;&#x6CD5;&#x6C92;&#x6709;&#x8FA6;&#x6CD5;&#x88AB; IDE &#x767C;&#x73FE;&#xFF0C;&#x9019;&#x6A23;&#x5C0E;&#x5165;&#x8B93;&#x4F60;&#x4E0D;&#x6703;&#x7F3A;&#x5C11;&#x4F60;&#x6703;&#x9700;&#x8981;&#x7528;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x91CD;&#x8981;&#x65B9;&#x6CD5;&#x3002;</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> tornadofx.*

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView</span>: <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = vbox {
        button(<span class="hljs-string">&quot;Press me&quot;</span>)
        label(<span class="hljs-string">&quot;Waiting&quot;</span>)
    }
}
</code></pre>
<p>TorandoFX &#x63D0;&#x4F9B; builder &#x65B9;&#x6CD5;&#x4F86;&#x6E1B;&#x5C11; UI code&#xFF0C;&#x800C;&#x4E0D;&#x7528;&#x5275;&#x5EFA; UI &#x4F86;&#x624B;&#x52D5;&#x7684;&#x5C07;&#x5176;&#x6DFB;&#x52A0;&#x5230;&#x5143;&#x4EF6;&#x5217;&#x8868;&#xFF0C;builder &#x5141;&#x8A31;&#x6211;&#x5011;&#x7528;&#x6709;&#x5C64;&#x6B21;&#x7684;&#x7D50;&#x69CB;&#x4F86;&#x8868;&#x9054;&#x6211;&#x5011;&#x7684; UI&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x975E;&#x5E38;&#x7C21;&#x55AE;&#x7684;&#x65B9;&#x6CD5;&#x4F86;&#x5275;&#x5EFA; UI&#x3002;</p>
<p>&#x8ACB;&#x6CE8;&#x610F;&#x6240;&#x6709;&#x7684; <code>builder</code> &#x90FD;&#x662F;&#x4F7F;&#x7528;&#x5C0F;&#x5BEB;&#x82F1;&#x6587;&#x5B57;&#xFF0C;&#x9019;&#x6A23;&#x624D;&#x4E0D;&#x6703;&#x548C;&#x624B;&#x52D5;&#x5275;&#x5EFA; UI &#x985E;&#x5225;&#x641E;&#x6DF7;&#x3002;</p>
<h2 id="&#x57F7;&#x884C;&#x4E00;&#x500B;-tornadofx-&#x61C9;&#x7528;&#x7A0B;&#x5F0F;">&#x57F7;&#x884C;&#x4E00;&#x500B; TornadoFX &#x61C9;&#x7528;&#x7A0B;&#x5F0F;</h2>
<p>&#x6700;&#x65B0;&#x7684; JAM &#x7248;&#x672C;&#x77E5;&#x9053;&#x8981;&#x5982;&#x4F55;&#x5728;&#x6C92;&#x6709; <code>main()</code> &#x65B9;&#x6CD5;&#x7684;&#x5F62;&#x6CC1;&#x4E0B;&#x57F7;&#x884C; JavaFX &#x7684;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x3002;&#x56E0;&#x70BA; <code>tornadofx.App</code> &#x7E7C;&#x627F;&#x4E86; <code>javafx.application.Application</code>&#xFF0C;&#x6240;&#x4EE5;&#x5169;&#x8005;&#x5728;&#x57F7;&#x884C;&#x4E0A;&#x4E26;&#x7121;&#x5340;&#x5225;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x4F60;&#x76F4;&#x63A5;&#x53EF;&#x4EE5;&#x57F7;&#x884C; <code>com.example.app.MyApp</code>&#xFF0C;&#x800C;&#x4E0D;&#x7528;&#x4F7F;&#x7528; <code>main()</code> &#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x7684;&#x4E8B;&#x4F8B;&#x662F;&#x4F7F;&#x7528;&#x5305;&#x5C64;&#x7D1A; (package level) &#x7684; main() &#x65B9;&#x6CD5;&#xFF1A;</p>
<pre><code class="lang-kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array&lt;String&gt;</span>)</span> {</span>
  launch<span class="hljs-type">&lt;MyApp&gt;</span>(args)
}
</code></pre>
<p>&#x9019;&#x500B; main &#x65B9;&#x6CD5;&#x6703;&#x88AB;&#x7DE8;&#x8B6F;&#x70BA; <code>com.example.app.MyAppKt</code>&#xFF0C;&#x6CE8;&#x610F;&#x7D50;&#x5C3E;&#x70BA; <code>Kt</code>&#x3002;&#x7576;&#x4F60;&#x5275;&#x5EFA;&#x4E86;&#x4E00;&#x500B;&#x5305;&#x5C64;&#x7D1A; (package lavel) &#x7684; main &#x65B9;&#x6CD5;&#xFF0C;&#x5C31;&#x6703;&#x81EA;&#x52D5;&#x5275;&#x5EFA;&#x4E00;&#x500B;&#x540D;&#x7A31;&#x70BA;&#x6A94;&#x540D;&#x52A0;&#x4E0A; <code>Kt</code> &#x7684;&#x985E;&#x5225;&#x3002;</p>
<p>&#x8981;&#x555F;&#x52D5;&#x548C;&#x6E2C;&#x8A66; <code>App</code>&#xFF0C;&#x6211;&#x5011;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; Intellij IDEA&#xFF0C;&#x6B65;&#x9A5F;&#x5982;&#x4E0B;&#xFF1A; <em>Run</em>&#x2192;<em>Edit Configurations</em></p>
<p><img src="https://i.imgur.com/msTSPNm.png" alt="3.1"></p>
<p>&#x9EDE;&#x64CA;&#x7DA0;&#x8272; &quot;+&quot; &#x65B0;&#x589E;&#x4E00;&#x500B; Application configuration&#x3002;</p>
<p><img src="https://i.imgur.com/OeejuvB.png" alt="3.2"></p>
<p>&#x8F38;&#x5165;&#x4F60;&#x7684; Main class &#x540D;&#x7A31;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4F60;&#x7684;&#x985E;&#x5225; <code>App</code> &#x7684;&#x540D;&#x7A31;&#x3002;&#x9084;&#x5FC5;&#x9808;&#x6307;&#x5B9A; module&#xFF0C;&#x548C;&#x4E00;&#x500B;&#x6709;&#x610F;&#x7FA9;&#x7684;&#x540D;&#x7A31; (&#x4E0B;&#x9762;&#x662F;&#x7528; Launcher)&#x3002;</p>
<p><img src="https://i.imgur.com/0QayTdJ.png" alt="3.3"></p>
<p>&#x8981;&#x555F;&#x52D5; TornadoFX &#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#xFF0C;&#x9078;&#x64C7; <em>Run</em>&#x2192;<em>Run &apos;Launcher&apos;</em> &#x6216;&#x662F;&#x4EFB;&#x4F55;&#x4F60;&#x5B9A;&#x7FA9;&#x7684;&#x540D;&#x7A31;&#x3002;</p>
<p><img src="https://i.imgur.com/9HvQpTe.png" alt="3.4"></p>
<p>&#x9019;&#x6A23;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7A0B;&#x5F0F;&#x57F7;&#x884C;&#x3002;</p>
<p><img src="https://i.imgur.com/agTMNS3.png" alt="3.5"></p>
<p>&#x606D;&#x559C;&#xFF0C;&#x4F60;&#x6210;&#x529F;&#x5B8C;&#x6210;&#x4E86;&#x4F60;&#x7684;&#x7B2C;&#x4E00;&#x500B; TorandoFX &#x7A0B;&#x5F0F;&#xFF0C;&#x96D6;&#x7136;&#x73FE;&#x5728;&#x770B;&#x8D77;&#x4F86;&#x5F88;&#x7C21;&#x55AE;&#xFF0C;&#x4F46;&#x96A8;&#x8457;&#x6211;&#x5011;&#x4ECB;&#x7D39;&#x8DDF;&#x591A;&#x7684; TornadoFX &#x53B2;&#x5BB3;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x53EF;&#x4EE5;&#x5275;&#x5EFA;&#x66F4;&#x5927;&#x66F4;&#x4EE4;&#x4EBA;&#x5370;&#x8C61;&#x6DF1;&#x523B;&#x7684;&#x7A0B;&#x5F0F;&#xFF0C;&#x4E14;&#x53EA;&#x9700;&#x8981;&#x5C11;&#x91CF;&#x7684;&#x7A0B;&#x5F0F;&#x78BC;&#x3002;&#x8B93;&#x6211;&#x5011;&#x5148;&#x4F86;&#x4E86;&#x66F4;&#x6DF1;&#x5165;&#x7684;&#x89E3; <code>App</code> &#x548C; <code>View</code>&#x3002;</p>
<h2 id="&#x4E86;&#x89E3;-views">&#x4E86;&#x89E3; Views</h2>
<p>&#x8B93;&#x6211;&#x5011;&#x4F86;&#x6DF1;&#x5165;&#x7684;&#x4E86;&#x89E3; <code>View</code> &#x7684;&#x5DE5;&#x4F5C;&#x6A21;&#x5F0F;&#x548C;&#x5F15;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x4E00;&#x500B; <code>View</code> &#x63D0;&#x4F9B;&#x968E;&#x5C64;&#x5F0F;&#x7684; JavaFX &#x7BC0;&#x9EDE;&#xFF0C;&#x4E26;&#x4E14;&#x5F9E; root &#x958B;&#x59CB;&#x3002;&#x5728;&#x4E0B;&#x4E00;&#x500B;&#x90E8;&#x4EFD;&#xFF0C;&#x6211;&#x5011;&#x6703;&#x5B78;&#x7FD2;&#x5982;&#x4F55;&#x5229;&#x7528;&#x5EFA;&#x69CB;&#x5668;&#x4F86;&#x5275;&#x5EFA; <code>Node</code> &#x7D50;&#x69CB;&#x3002;TornadoFX &#x53EA;&#x6709;&#x7BA1;&#x7406;&#x4E00;&#x500B; <code>MyView</code> &#x4F86;&#x78BA;&#x4FDD;&#x53EA;&#x6709;&#x55AE;&#x4E00;&#x7269;&#x4EF6; (singleton)&#x3002;TornadoFX &#x9084;&#x652F;&#x63F4;&#x4E86; scopes&#xFF0C;&#x53EF;&#x4EE5;&#x8B93; <code>View</code>&#x3001;<code>Fragment</code>&#x3001;<code>Controller</code> &#x4FDD;&#x6301;&#x5728;&#x540C;&#x4E00;&#x500B;&#x7FA4;&#x7D44;&#xFF0C;&#x8B93; <code>View</code> &#x78BA;&#x4FDD;&#x53EA;&#x6709;&#x55AE;&#x4E00;&#x7269;&#x4EF6;&#x3002;&#x9019;&#x975E;&#x5E38;&#x9069;&#x5408; <a href="https://msdn.microsoft.com/en-us/library/aa263481.aspx" target="_blank">Multiple-Document Interface applications</a>&#x3002;</p>
<h2 id="&#x5D4C;&#x5165;-views">&#x5D4C;&#x5165; Views</h2>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x5D4C;&#x5165;&#x4E00;&#x500B;&#x6216;&#x591A;&#x500B; Views &#x5230;&#x5176;&#x4ED6;&#x7684; View &#x4E2D;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x6211;&#x5011;&#x5D4C;&#x5165;&#x4E86;&#x4E00;&#x500B; <code>TopView</code> &#x548C;&#x4E00;&#x500B; <code>BottomView</code> &#x5230;&#x4E00;&#x500B; <code>MasterView</code> &#x4E2D;&#xFF0C;&#x4E26;&#x5C07;&#x9019;&#x4E9B;&#x5B50; View &#x5206;&#x6D3E;&#x7D66; <code>BorderPane</code>&#x3002;</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> javafx.scene.control.Label
<span class="hljs-keyword">import</span> javafx.scene.layout.BorderPane
<span class="hljs-keyword">import</span> tornadofx.*


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MasterView</span>: <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = borderpane {
        top<span class="hljs-type">&lt;TopView&gt;</span>()
        bottom<span class="hljs-type">&lt;BottomView&gt;</span>()
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TopView</span>: <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = label(<span class="hljs-string">&quot;Top View&quot;</span>)
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BottomView</span>: <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = label(<span class="hljs-string">&quot;Bottom View&quot;</span>)
}
</code></pre>
<h2 id="injection-using-find-or-inject">Injection Using find() or inject()</h2>
<p>The <code>inject()</code> delegate will lazily assign a given component to a property. The first time that component is called is when it will be retrieved.
Alternatively, instead of using the <code>inject()</code> delegate you can use the <code>find()</code> function to retrieve a singleton instance of a <code>View</code> or other components. In the following example
we retrieve an instance of the <code>TopView</code> and <code>BottomView</code> using <code>inject()</code> and <code>find()</code> respectively, and assign the root element of those sub views to the sections inside the <code>BorderPane</code>.
This is normally not necessary but might help you understand how the above short hand works under the covers.</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> javafx.scene.control.Label
<span class="hljs-keyword">import</span> javafx.scene.layout.BorderPane
<span class="hljs-keyword">import</span> tornadofx.*


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MasterView</span> : <span class="hljs-type">View</span></span>() {
    <span class="hljs-comment">// Explicitly retrieve TopView</span>
    <span class="hljs-variable"><span class="hljs-keyword">val</span> topView</span> = find(TopView::<span class="hljs-class"><span class="hljs-keyword">class</span>)</span>
    <span class="hljs-comment">// Create a lazy reference to BottomView</span>
    <span class="hljs-variable"><span class="hljs-keyword">val</span> bottomView</span>: BottomView by inject()

    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = borderpane {
        top = topView.root
        bottom = bottomView.root
    }
}
</code></pre>
<p>You can use either <code>find()</code> or <code>inject()</code>, but using <code>inject()</code> delegates is the most idiomatic means to perform dependency injection and has the advantage of lazy loading.</p>
<h2 id="controllers">Controllers</h2>
<p>In many cases, it is considered a good practice to separate a UI into three distinct parts:</p>
<ol>
<li><strong>Model</strong> - The business code layer that holds core logic and data</li>
<li><strong>View</strong> - The visual display with various input and output controls</li>
<li><strong>Controller</strong> - The &quot;middleman&quot; mediating events between the Model and the View</li>
</ol>
<blockquote>
<p>There are other flavors of MVC like MVVM and MVP, all of which can be leveraged in TornadoFX.</p>
</blockquote>
<p>While you could put all logic from the Model and Controller right into the view, it is often cleaner to separate these three pieces distinctly to maximize reusability. One commonly used pattern to accomplish this is the MVC pattern. In TornadoFX, a <code>Controller</code> can be injected to support a <code>View</code>.</p>
<p>Here is a simple example. Create a simple <code>View</code> with a <code>TextField</code> whose value is bound to an observable string property and later written to a &quot;database&quot; when a <code>Button</code> is clicked. We can inject a <code>Controller</code> that handles interacting with the model that writes to the database. Since this example is simplified, there will be no database but a printed message will serve as a placeholder (Figure 3.7).</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> tornadofx.*


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView</span> : <span class="hljs-type">View</span></span>() {
    <span class="hljs-variable"><span class="hljs-keyword">val</span> controller</span>: MyController by inject()
    <span class="hljs-variable"><span class="hljs-keyword">val</span> input</span> = SimpleStringProperty()

    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = form {
        fieldset {
            field(<span class="hljs-string">&quot;Input&quot;</span>) {
                textfield(input)
            }

            button(<span class="hljs-string">&quot;Commit&quot;</span>) {
                action {
                    controller.writeToDb(input.value)
                    input.value = <span class="hljs-string">&quot;&quot;</span>
                }
            }
       }
    }
}


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span>: <span class="hljs-type">Controller</span></span>() {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">writeToDb</span><span class="hljs-params">(inputValue: <span class="hljs-type">String</span>)</span> {</span>
        println(<span class="hljs-string">&quot;Writing $inputValue to database!&quot;</span>)
    }
}
</code></pre>
<p>Notice how the <code>input</code> property is automatically bound to the textfield just by referencing it in the <code>textfield</code> builder. As an alternative, you could have created a
reference to the textfield and retrieved its <code>text</code> property, but that approach would create more complex UI code without much benefit. In rare cases you might
need to reference individual UI elements.</p>
<p><strong>Figure 3.7</strong></p>
<p><img src="https://i.imgur.com/CKG7Fb9.png" alt=""></p>
<p>When we build the UI, we make sure to add a reference to the <code>inputField</code> so that it can be referenced from the <code>onClick</code>
event handler of the &quot;Commit&quot; button later, hence why we save it to a variable. When the &quot;Commit&quot; button is clicked, you will see the Controller prints  a line to the console.</p>
<pre><code>Writing Alpha to database!
</code></pre><p>It is important to note that while the above code works, and may even look pretty good, it is a good practice to avoid
referencing other UI elements directly. Your code will be much easier to refactor if you bind your UI elements to
properties and manipulate the properties instead. We will introduce the <code>ViewModel</code> later, which provides even easier
ways to deal with this type of interaction.</p>
<p>You can also use Controllers to provide data to a <code>View</code> (Figure 3.8).</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> javafx.collections.FXCollections
<span class="hljs-keyword">import</span> tornadofx.*


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView</span> : <span class="hljs-type">View</span></span>() {
    <span class="hljs-variable"><span class="hljs-keyword">val</span> controller</span>: MyController by inject()

    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = vbox {
        label(<span class="hljs-string">&quot;My items&quot;</span>)
        listview(controller.values)
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span>: <span class="hljs-type">Controller</span></span>() {
    <span class="hljs-variable"><span class="hljs-keyword">val</span> values</span> = FXCollections.observableArrayList(<span class="hljs-string">&quot;Alpha&quot;</span>,<span class="hljs-string">&quot;Beta&quot;</span>,<span class="hljs-string">&quot;Gamma&quot;</span>,<span class="hljs-string">&quot;Delta&quot;</span>)
}
</code></pre>
<p><strong>Figure 3.8</strong></p>
<p><img src="https://i.imgur.com/oKL9ZVD.png" alt=""></p>
<p>The <code>VBox</code> contains a <code>Label</code> and a <code>ListView</code>, and the <code>items</code> property of the <code>ListView</code> is assigned to the <code>values</code> property of our <code>Controller</code>.</p>
<p>Whether they are reading or writing data, Controllers can have long-running tasks and should not perform work on the JavaFX thread. We will learn how to easily offload work to a worker thread using the <code>runAsync</code> construct next.</p>
<h3 id="long-running-tasks">Long Running Tasks</h3>
<p>Whenever you call a function in a controller, you need to determine if that function returns immediately or if it
performs potentially long-running tasks. If you call a function on the JavaFX Application Thread, the UI
will be unresponsive until the call completes. Unresponsive UI&apos;s is a killer for user acceptance, so we need to make sure to run expensive operations in the background. TornadoFX provides the <code>runAsync</code> function to help with this.</p>
<p>Code placed inside a <code>runAsync</code> block will run in the background. If the result of the background call should update your UI, you must make sure that you apply the changes on the JavaFX Application Thread. The <code>ui</code> block, which typically follows, does exactly that.</p>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> textfield</span> = textfield()
button(<span class="hljs-string">&quot;Update text&quot;</span>) {
    action {
        runAsync {
            myController.loadText()
        } ui { loadedText -&gt;
            textfield.text = loadedText
        }
    }
}
</code></pre>
<p>When the button is clicked, the action inside the <code>action</code> builder is run. It makes a call out to <code>myController.loadText()</code>and applies the result to the text property of the textfield when it returns. The UI stays responsive while the controller function runs.</p>
<p>Under the covers, <code>runAsync</code> creates a JavaFX <code>Task</code> objects, and spins off a separate thread to run your call inside the <code>Task</code>. You can even assign this <code>Task</code> to a variable and bind it to a UI to show progress while your operation is running.</p>
<p>In fact, this is so common that there is also a default ViewModel called <code>TaskStatus</code> which contains observable values
 for <code>running</code>, <code>message</code>, <code>title</code>, and <code>progress</code>. You can supply the <code>runAsync</code> call with a specific instance of the <code>TaskStatus</code> object, or use the default. There is also a version of <code>runAsync</code> called <code>runAsyncWithProgress</code> which will cover the current <code>Node</code> with a progress indicator while the long running operation runs.</p>
<p>The TornadoFX sources includes an example usage of this in the <code>AsyncProgressApp.kt</code> file.</p>
<blockquote>
<p>If you need to handle a great deal of complex concurrency, you may consider using <a href="https://github.com/ReactiveX/RxKotlin" target="_blank">RxKotlin</a> with <a href="https://github.com/thomasnield/RxKotlinFX" target="_blank">RxKotlinFX</a>. Rx also has the ability to handle rapid user inputs and events, and kill previous requests to only chase after the latest.</p>
</blockquote>
<h2 id="fragment">Fragment</h2>
<p>Any <code>View</code> you create is a singleton, which means you typically use it in only one place at a time. The reason for this is that the root node of the <code>View</code> can only have a single parent in a JavaFX application. If you assign it another parent, it will disappear from its previous parent.</p>
<p>However, if you would like to create a piece of UI that is short-lived or can be used in multiple places, consider using
a <code>Fragment</code>. A <strong>Fragment</strong> is a special type of <code>View</code> designed to have multiple instances. They are particularly useful for popups or as pieces of a larger UI (such as ListCells, which we look at via the <code>ListCellFragment</code> later).</p>
<p>Both <code>View</code> and <code>Fragment</code> support <code>openModal()</code>, <code>openWindow()</code>, and <code>openInternalWindow()</code> functions that will open the root node in a separate Window.</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> javafx.stage.StageStyle
<span class="hljs-keyword">import</span> tornadofx.*


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView</span> : <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = vbox {
        button(<span class="hljs-string">&quot;Press Me&quot;</span>) {
            action {
                find<span class="hljs-type">&lt;MyFragment&gt;</span>().openModal(stageStyle = StageStyle.UTILITY)
            }
        }
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyFragment</span>: <span class="hljs-type">Fragment</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = label(<span class="hljs-string">&quot;This is a popup&quot;</span>)
}
</code></pre>
<p>You can also pass optional arguments to <code>openModal()</code> to modify a few of its behaviors</p>
<p><strong>Optional Arguments for openModal()</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>stageStyle</td>
<td>StageStyle</td>
<td>Defines one of the possible enum styles for <code>Stage</code>. Default: <code>StageStyle.DECORATED</code></td>
</tr>
<tr>
<td>modality</td>
<td>Modality</td>
<td>Defines one of the possible enum modality types for <code>Stage</code>. Default: <code>Modality.APPLICATION_MODAL</code></td>
</tr>
<tr>
<td>escapeClosesWindow</td>
<td>Boolean</td>
<td>Sets the <code>ESC</code> key to call <code>close()</code>. Default: <code>true</code></td>
</tr>
<tr>
<td>owner</td>
<td>Window</td>
<td>Specify the owner Window for this Stage`</td>
</tr>
<tr>
<td>block</td>
<td>Boolean</td>
<td>Block UI execution until the Window closes. Default: <code>false</code></td>
</tr>
</tbody>
</table>
<h2 id="internalwindow">InternalWindow</h2>
<p>While <code>openModal</code> opens in a new <code>Stage</code>, <code>openInternalWindow</code> opens over the current root node, or any other node if you specify it:</p>
<pre><code class="lang-kotlin">    button(<span class="hljs-string">&quot;Open editor&quot;</span>) {
        action {
            openInternalWindow<span class="hljs-type">&lt;Editor&gt;</span>()
        }
    }
</code></pre>
<p><strong>Figure 3.9</strong></p>
<p><img src="https://i.imgur.com/7Z0X5QL.png" alt=""></p>
<p>A good use case for the internal window is for single stage environments like JPro, or if you want to customize the window trim to make the window appear more in line with the design of your application. The Internal Window can be styled with CSS. Take a look at the <code>InternalWindow.Styles</code> class for more information about styleable properties.</p>
<p>The internal window API differs from modal/window in one important aspect. Since the window opens over an existing node, you typically call <code>openInternalWindow()</code> from within the <code>View</code> you want it to open on top of. You supply the View you want to show, and you can optionally supply what node to open over via the <code>owner</code> parameter.</p>
<p><strong>Optional Arguments for openInternalWindow()</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>view</td>
<td>UIComponent</td>
<td>The component will be the content of the new window</td>
</tr>
<tr>
<td>view</td>
<td>KClass<uicomponent></uicomponent></td>
<td>Alternatively, you can supply the class of the view instead of an instance</td>
</tr>
<tr>
<td>icon</td>
<td>Node</td>
<td>Optional window icon</td>
</tr>
<tr>
<td>scope</td>
<td>Scope</td>
<td>If you specify the view class, you can also specify the scope used to fetch the view</td>
</tr>
<tr>
<td>modal</td>
<td>Boolean</td>
<td>Defines if the covering node should be disabled while the internal window is active. Default: <code>true</code></td>
</tr>
<tr>
<td>escapeClosesWindow</td>
<td>Boolean</td>
<td>Sets the <code>ESC</code> key to call <code>close()</code>. Default: <code>true</code></td>
</tr>
<tr>
<td>owner</td>
<td>Node</td>
<td>Specify the owner Node for this window. The window will by default cover the root node of this view.`</td>
</tr>
</tbody>
</table>
<h2 id="closing-modal-windows">Closing Modal Windows</h2>
<p>Any <code>Component</code> opened using <code>openModal()</code>, <code>openWindow()</code> or <code>openInternalWindow()</code> can be closed by calling <code>close()</code>. It is also possible to get to the <code>InternalWindow</code> instance directly if needed using <code>findParentOfType(InternalWindow::class)</code>.</p>
<h2 id="replacing-views-and-docking-events">Replacing Views and Docking Events</h2>
<p>With TornadoFX, is easy to swap your current <code>View</code> with another <code>View</code> using <code>replaceWith()</code>, and optionally add a transition. In the example below, a <code>Button</code> on each <code>View</code> will switch to the other view, which can be <code>MyView1</code> or <code>MyView2</code> (Figure 3.10).</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> tornadofx.*


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView1</span>: <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = vbox {
        button(<span class="hljs-string">&quot;Go to MyView2&quot;</span>) {
            action {
                replaceWith<span class="hljs-type">&lt;MyView2&gt;</span>()
            }
        }
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView2</span>: <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = vbox {
        button(<span class="hljs-string">&quot;Go to MyView1&quot;</span>) {
            action {
                replaceWith<span class="hljs-type">&lt;MyView1&gt;</span>()
            }
        }
    }
}
</code></pre>
<p><strong>Figure 3.10</strong></p>
<p><img src="https://i.imgur.com/IkInGZh.png" alt=""></p>
<p>You also have the option to specify a spiffy animation for the transition between the two Views, as shown below.</p>
<pre><code class="lang-kotlin">replaceWith(MyView1::<span class="hljs-class"><span class="hljs-keyword">class</span>, <span class="hljs-type">ViewTransition.Slide</span></span>(<span class="hljs-number">0.3</span>.seconds, ViewTransition.Direction.LEFT))
</code></pre>
<p>This works by replacing the <code>root</code> <code>Node</code> on a given <code>View</code> with another <code>View</code>&apos;s <code>root</code>. There are two functions you can override on <code>View</code> to leverage when a View&apos;s <code>root</code> <code>Node</code> is connected to a parent (<code>onDock()</code>), and when it is disconnected (<code>onUndock()</code>). You can leverage these two events to connect and &quot;clean up&quot; whenever a <code>View</code> comes in or falls out. You will notice running the code below that whenever a <code>View</code> is swapped, it will undock that previous <code>View</code> and dock the new one. You can leverage these two events to manage initialization and disposal tasks.</p>
<pre><code class="lang-kotlin"><span class="hljs-keyword">import</span> tornadofx.*


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView1</span>: <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = vbox {
        button(<span class="hljs-string">&quot;Go to MyView2&quot;</span>) {
            action {
                replaceWith<span class="hljs-type">&lt;MyView2&gt;</span>()
            }
        }
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDock</span><span class="hljs-params">()</span> {</span>
        println(<span class="hljs-string">&quot;Docking MyView1!&quot;</span>)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onUndock</span><span class="hljs-params">()</span> {</span>
        println(<span class="hljs-string">&quot;Undocking MyView1!&quot;</span>)
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyView2</span>: <span class="hljs-type">View</span></span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-variable"><span class="hljs-keyword">val</span> root</span> = vbox {
        button(<span class="hljs-string">&quot;Go to MyView1&quot;</span>) {
            action {
                replaceWith<span class="hljs-type">&lt;MyView1&gt;</span>()
            }
        }
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDock</span><span class="hljs-params">()</span> {</span>
        println(<span class="hljs-string">&quot;Docking MyView2!&quot;</span>)
    }
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onUndock</span><span class="hljs-params">()</span> {</span>
        println(<span class="hljs-string">&quot;Undocking MyView2!&quot;</span>)
    }
}
</code></pre>
<h2 id="passing-parameters-to-views">Passing Parameters to Views</h2>
<p>The best way to pass information between views is often an injected <code>ViewModel</code>. Even so, it can still be convenient to be able to pass parameters to other components. The <code>find</code> and <code>inject</code> functions supports varargs of <code>Pair&lt;String, Any&gt;</code> which can be used for just this purpose. Consider a customer list that opens a customer editor for the selected customer. The action to edit a customer might look like this:</p>
<pre><code class="lang-kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">editCustomer</span><span class="hljs-params">(customer: <span class="hljs-type">Customer</span>)</span> {</span>
    find<span class="hljs-type">&lt;CustomerEditor&gt;</span>(mapOf(CustomerEditor::customer to customer)).openWindow()
}
</code></pre>
<p>The parameters are passed as a map, where the key is the property in the view and the value is whatever you want the property to be. This gives you a type safe way of configuring parameters for the target View.</p>
<p>Here we use the Kotlin <code>to</code> syntax to create the parameter. This could also have been written as <code>Pair(CustomerEditor::customer, customer)</code> if you prefer. The editor can now access the parameter like this:</p>
<pre><code class="lang-kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomerEditor</span> : <span class="hljs-type">Fragment</span></span>() {
    <span class="hljs-variable"><span class="hljs-keyword">val</span> customer</span>: Customer by param()
}
</code></pre>
<p>If you want to inspect the parameters instead of blindly relying on them to be available, you can either declare them as nullable or consult the <code>params</code> map:</p>
<pre><code class="lang-kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomerEditor</span> : <span class="hljs-type">Fragment</span></span>() {
    init {
        <span class="hljs-variable"><span class="hljs-keyword">val</span> customer</span> = params[<span class="hljs-string">&quot;customer&quot;</span>] <span class="hljs-keyword">as</span>? Customer
        <span class="hljs-keyword">if</span> (customer != <span class="hljs-literal">null</span>) {
            ...
        }
    }
}
</code></pre>
<p>If you do not care about type safety you can also pass parameters as <code>mapOf(&quot;customer&quot; to customer)</code>, but then you miss out on automatic refactoring if you rename a property in the target view.</p>
<h2 id="accessing-the-primary-stage">Accessing the Primary Stage</h2>
<p><code>View</code> has a property called <code>primaryStage</code> that allows you to manipulate properties of the <code>Stage</code> backing it, such as window size. Any <code>View</code> or <code>Fragment</code> that were opened via <code>openModal</code> will also have a <code>modalStage</code> property available.</p>
<h2 id="accessing-the-scene">Accessing the Scene</h2>
<p>Sometimes it is necessary to get a hold of the current scene from within a <code>View</code> or <code>Fragment</code>. This can be achieved with <code>root.scene</code>, or if you are within a type safe builder, just call <code>scene</code>.</p>
<h2 id="accessing-resources">Accessing Resources</h2>
<p>Lots of JavaFX APIs takes resources as a <code>URL</code> or the <code>toExternalForm</code> of an URL. To retrieve a resource url one would typically write something like:</p>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> myAudioClip</span> = AudioClip(MyView::<span class="hljs-class"><span class="hljs-keyword">class</span>.<span class="hljs-title">java</span>.<span class="hljs-title">getResource</span></span>(<span class="hljs-string">&quot;mysound.wav&quot;</span>).toExternalForm())
</code></pre>
<p>However, every <code>Component</code> has a <code>resources</code> object which can retrieve the external form url of a resource like this:</p>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> myAudiClip</span> = AudioClip(resources[<span class="hljs-string">&quot;mysound.wav&quot;</span>])
</code></pre>
<p>If you need an actual <code>URL</code>, it can be retrieved like this:</p>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> myResourceURL</span> = resources.url(<span class="hljs-string">&quot;mysound.wav&quot;</span>)
</code></pre>
<p>The <code>resources</code> helper also has several other helpful functions to help you turn files relative to the <code>Component</code> into an object of the type you need:</p>
<pre><code class="lang-kotlin"><span class="hljs-variable"><span class="hljs-keyword">val</span> myJsonObject</span> = resources.json(<span class="hljs-string">&quot;myobject.json&quot;</span>)
<span class="hljs-variable"><span class="hljs-keyword">val</span> myJsonArray</span> = resources.jsonArray(<span class="hljs-string">&quot;myarray.json&quot;</span>)
<span class="hljs-variable"><span class="hljs-keyword">val</span> myStream</span> = resources.stream(<span class="hljs-string">&quot;somefile&quot;</span>)
</code></pre>
<blockquote>
<p>It is worth mentioning that the <code>json</code> and <code>jsonArray</code> functions are also available on <code>InputStream</code> objects.</p>
</blockquote>
<p>Resources are relative to the <code>Component</code> but you can also retrieve a resource by it&apos;s full path, starting with a <code>/</code>.</p>
<h2 id="summary">Summary</h2>
<p>TornadoFX is filled with simple, streamlined, and powerful injection tools to manage Views and Controllers. It also streamlines dialogs and other small UI pieces using <code>Fragment</code>. While the applications we built so far are pretty simple, hopefully you appreciate the simplified concepts TornadoFX introduces to JavaFX. In the next chapter we will cover what is arguably the most powerful feature of TornadoFX: Type-Safe Builders.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="2. Setting Up.html" class="navigation navigation-prev " aria-label="Previous page: 2. 配置">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="4. Basic Controls.html" class="navigation navigation-next " aria-label="Next page: 4. Basic Controls">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"3. 組件","level":"1.2.3","depth":2,"next":{"title":"4. Basic Controls","level":"1.2.4","depth":2,"path":"part1/4. Basic Controls.md","ref":"part1/4. Basic Controls.md","articles":[]},"previous":{"title":"2. 配置","level":"1.2.2","depth":2,"path":"part1/2. Setting Up.md","ref":"part1/2. Setting Up.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"part1/3. Components.md","mtime":"2020-02-13T15:46:37.950Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-02-13T15:47:39.413Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

